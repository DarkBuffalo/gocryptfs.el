#+title: gocryptfs.el

#+HTML: <img src="assets/logo.png" align="right">

=gocryptfs.el= is an Emacs Lisp package that provides native Emacs commands to
*initialize, mount, unmount, and manage multiple gocryptfs-encrypted directories
(“vaults”)*.

The package integrates gocryptfs cleanly into the Emacs workflow, without shell
wrappers, while correctly handling the real-world constraints of FUSE-based
filesystems.


* Security Considerations

- The password is never passed through the shell
- No use of echo | gocryptfs
- No plaintext password storage
- Sensitive input is sent exclusively via the gocryptfs process standard input

* Requirements
- install [[https://github.com/rfjakob/gocryptfs][gocryptfs]]

    #+begin_src sh
      sudo pacman -S gocryptfs
    #+end_src


* Installation
#+begin_src elisp
  (use-package gocryptfs
    :straight (:local-repo "~/your folder/gocryptfs")
    :custom
    (gocryptfs-vaults
     '((:name "personal"
              :cipher-dir "~/.tomb"
              :mount-dir "~/Perso")
       (:name "pro"
              :cipher-dir "~/.tomb2"
              :mount-dir "~/Pro"))))
#+end_src


* Usage

** Initialize a vault

Before mounting a vault for the first time, it must be initialized:

#+BEGIN_SRC emacs-lisp
M-x gocryptfs-init-vault
#+END_SRC

This command:
- creates required directories if needed
- validates that the cipher directory is empty
- securely asks for a password (twice)
- runs =gocryptfs -init=

** Mount a vault

#+BEGIN_SRC emacs-lisp
M-x gocryptfs-mount
#+END_SRC

You will be prompted to select a vault and enter its password.

The mount process is asynchronous and does not block Emacs.

** Unmount a vault

#+BEGIN_SRC emacs-lisp
M-x gocryptfs-umount
#+END_SRC




#+BEGIN: github-commits :user DarkBuffalo :repo gocryptfs.el :n 5
* Latest commits
- [[https://github.com/DarkBuffalo/gocryptfs.el/commit/93a039a][93a039a]] - fix: doc
- [[https://github.com/DarkBuffalo/gocryptfs.el/commit/f753abe][f753abe]] - doc: org file
- [[https://github.com/DarkBuffalo/gocryptfs.el/commit/f1af34a][f1af34a]] - add: security
- [[https://github.com/DarkBuffalo/gocryptfs.el/commit/fe43b40][fe43b40]] - fix: minor error
- [[https://github.com/DarkBuffalo/gocryptfs.el/commit/81d69e5][81d69e5]] - fix: readme

#+END:


# Local Variables:
# eval: (defun org-dblock-write:github-commits (params)
#         (let* ((user (or (plist-get params :user) "TON-UTILISATEUR"))
#                (repo (or (plist-get params :repo) "TON-DEPOT"))
#                (num (or (plist-get params :n) 5))
#                (url (format "https://api.github.com/repos/%s/%s/commits?per_page=%d" user repo num))
#                (json (with-temp-buffer
#                        (url-insert-file-contents url)
#                        (json-parse-buffer :array-type 'list))))
#           (insert "* Latest commits\n")
#           (dolist (commit json)
#             (let ((sha (substring (gethash "sha" commit) 0 7))
#                   (message (gethash "message" (gethash "commit" commit))))
#               (insert (format "- [[https://github.com/%s/%s/commit/%s][%s]] - %s\n"
#                               user repo sha sha message))))))
# End:
